//–ö–∞–∫–≤–æ –ø—Ä–∞–≤–∏ –∫–æ–¥–∞
//–¢—ä—Ä—Å–∏ —Ñ–∏–ª–º–∏,
//–ü–æ–∫–∞–∑–≤–∞ –ø–æ–ø—É–ª—è—Ä–Ω–∏ —Ñ–∏–ª–º–∏,
//–ö–∞–∑–≤–∞, –∞–∫–æ –∏–º–∞ –≥—Ä–µ—à–∫–∞,
//–ö–∞–∑–≤–∞ –¥–∞–ª–∏ –∑–∞—Ä–µ–∂–¥–∞ –Ω–µ—â–æ –≤ –º–æ–º–µ–Ω—Ç–∞.

//üì¶ –ö–∞–∫–≤–æ –≤–Ω–∞—Å—è–º–µ –æ—Ç –¥—Ä—É–≥–∏ —Ñ–∞–π–ª–æ–≤–µ:
//‚û°Ô∏è –¢–æ–≤–∞ —Å–∞ –≤—ä–ª—à–µ–±–Ω–∏ –∫—É–∫–∏—á–∫–∏ –æ—Ç React:
//useState ‚Äî –∏–∑–ø–æ–ª–∑–≤–∞–º–µ —è, –∑–∞ –¥–∞ –∑–∞–ø–∞–∑–∏–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è (–∫–∞—Ç–æ –ø–∞–º–µ—Ç).
import { useState, useEffect } from "react";
import { searchMovies } from "../services/api";
import { getPopularMovies } from "../services/api";
//‚û°Ô∏è –¢–æ–≤–∞ —Å–∞ —Ñ—É–Ω–∫—Ü–∏–∏ –æ—Ç –¥—Ä—É–≥ —Ñ–∞–π–ª, –∫–æ–π—Ç–æ –≥–æ–≤–æ—Ä–∏ —Å –∏–Ω—Ç–µ—Ä–Ω–µ—Ç, –∑–∞ –¥–∞ –≤–∑–µ–º–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è:
//getPopularMovies() ‚Äî –≤–∑–∏–º–∞ –Ω–∞–π-–ø–æ–ø—É–ª—è—Ä–Ω–∏—Ç–µ —Ñ–∏–ª–º–∏.
//searchMovies(–∏–º–µ) ‚Äî —Ç—ä—Ä—Å–∏ —Ñ–∏–ª–º–∏ –ø–æ –∏–º–µ.

//üé¨ –°—ä–∑–¥–∞–≤–∞–º–µ –∫—É–∫–∏—á–∫–∞—Ç–∞ useMovis:
//‚û°Ô∏è –¢–æ–≤–∞ –µ –Ω–∞—à–∞ —Å–æ–±—Å—Ç–≤–µ–Ω–∞ –∫—É–∫–∏—á–∫–∞ ‚Äì –∫–∞—Ç–æ –º–∞–ª–∫–æ —Ç–∞–π–Ω–æ —á–µ–∫–º–µ–¥–∂–µ, –∫—ä–¥–µ—Ç–æ —Å–ª–∞–≥–∞–º–µ —Ñ–∏–ª–º–∏, –≥—Ä–µ—à–∫–∏, –∏ –¥—Ä—É–≥–∏ –Ω–µ—â–∞.
const useMovis = () => {
  //üß† –°—ä—Å—Ç–æ—è–Ω–∏—è (–∫–∞–∫–≤–æ –ø–∞–∑–∏–º –≤ –ø–∞–º–µ—Ç—Ç–∞):
  const [searchQuery, setSearchQuery] = useState("");
  const [movies, setMovies] = useState([]);
  //‚û°Ô∏è –¢—É–∫ –ø–∞–∑–∏–º –∫–∞–∫–≤–æ –µ –Ω–∞–ø–∏—Å–∞–ª –ø–æ—Ç—Ä–µ–±–∏—Ç–µ–ª—è—Ç –∑–∞ —Ç—ä—Ä—Å–µ–Ω–µ.
  //const [movies, setMovies] = useState([]);
  const [error, setError] = useState(null);
  //‚û°Ô∏è –¢—É–∫ –ø–∞–∑–∏–º –∞–∫–æ –∏–º–∞ –≥—Ä–µ—à–∫–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä –Ω—è–º–∞ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç).
  const [loading, setLoading] = useState(true);
  //‚û°Ô∏è –¢—É–∫ –ø–∞–∑–∏–º –¥–∞–ª–∏ –Ω–µ—â–æ —Å–µ –∑–∞—Ä–µ–∂–¥–∞ –≤ –º–æ–º–µ–Ω—Ç–∞ (–∫–∞—Ç–æ "–≤—ä—Ä—Ç—è—â–æ—Ç–æ —Å–µ –∫—Ä—ä–≥—á–µ").

  //üöÄ –ö–æ–≥–∞—Ç–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ—Ç–æ —Å—Ç–∞—Ä—Ç–∏—Ä–∞:
  useEffect(() => {
    const loadPopularMovies = async () => {
      //‚û°Ô∏è –¢–æ–≤–∞ –∫–∞–∑–≤–∞: –∫–æ–≥–∞—Ç–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ—Ç–æ —Å–µ –æ—Ç–≤–æ—Ä–∏, –∏–∑–ø—ä–ª–Ω–∏ loadPopularMovies().
      //–ê —Ç—è –ø—Ä–∞–≤–∏ —Å–ª–µ–¥–Ω–æ—Ç–æ:
      try {
        const popularMovies = await getPopularMovies();
        setMovies(popularMovies);
        //‚û°Ô∏è –¢—ä—Ä—Å–∏ –ø–æ–ø—É–ª—è—Ä–Ω–∏ —Ñ–∏–ª–º–∏ –∏ –≥–∏ —Å–ª–∞–≥–∞ –≤ movies.
        //–ê–∫–æ –∏–º–∞ –≥—Ä–µ—à–∫–∞ ‚Äì –ø–æ–∫–∞–∑–≤–∞–º–µ —Å—ä–æ–±—â–µ–Ω–∏–µ. –ö–æ–≥–∞—Ç–æ –≤—Å–∏—á–∫–æ —Å–≤—ä—Ä—à–∏ ‚Äì —Å–ø–∏—Ä–∞–º–µ –∑–∞—Ä–µ–∂–¥–∞–Ω–µ—Ç–æ (loading = false).
      } catch (err) {
        console.log(err);
        setError("Failed to load movies...");
      } finally {
        setLoading(false);
      }
    };

    loadPopularMovies();
  }, []);

  //üîç –ö–æ–≥–∞—Ç–æ –ø–æ—Ç—Ä–µ–±–∏—Ç–µ–ª—è—Ç —Ç—ä—Ä—Å–∏ –Ω–µ—â–æ:
  const handleSearch = async (e) => {
    e.preventDefault();
    //‚û°Ô∏è –¢–∞–∑–∏ —Ñ—É–Ω–∫—Ü–∏—è —Å–µ –∏–∑–≤–∏–∫–≤–∞ –∫–æ–≥–∞—Ç–æ —á–æ–≤–µ–∫ –Ω–∞—Ç–∏—Å–Ω–µ "–¢—ä—Ä—Å–∏".
    if (!searchQuery.trim()) return;
    if (loading) return;

    setLoading(true);
    try {
      const searchResults = await searchMovies(searchQuery);
      setMovies(searchResults);
      setError(null);
    } catch (err) {
      console.log(err);
      setError("Failed to search movies...");
    } finally {
      setLoading(false);
    }
    //–°—Ç—ä–ø–∫–∏—Ç–µ:
    //1.–ê–∫–æ –ø–æ–ª–µ—Ç–æ –µ –ø—Ä–∞–∑–Ω–æ ‚Äì –Ω–µ –ø—Ä–∞–≤–∏–º –Ω–∏—â–æ.
    //2.–ê–∫–æ –≤–µ—á–µ –∑–∞—Ä–µ–∂–¥–∞–º–µ –Ω–µ—â–æ ‚Äì —Å—ä—â–æ –Ω–µ –ø—Ä–∞–≤–∏–º –Ω–∏—â–æ.
    //3.–ê–∫–æ –≤—Å–∏—á–∫–æ –µ –æ–∫:
    // –∑–∞–ø–æ—á–≤–∞–º–µ –∑–∞—Ä–µ–∂–¥–∞–Ω–µ,
    // —Ç—ä—Ä—Å–∏–º —Ñ–∏–ª–º–∏—Ç–µ,
    // —Å–ª–∞–≥–∞–º–µ –≥–∏ –≤ movies,
    // –∞–∫–æ –∏–º–∞ –≥—Ä–µ—à–∫–∞ ‚Äì —è –ø–∞–∑–∏–º.
  };

  //üì§ –ö–∞–∫–≤–æ –≤—Ä—ä—â–∞–º–µ –æ—Ç useMovis:
  return {
    setSearchQuery,
    movies,
    error,
    loading,
    handleSearch,
    searchQuery,
  };
  //‚û°Ô∏è –í—Ä—ä—â–∞–º–µ –≤—Å–∏—á–∫–æ –Ω—É–∂–Ω–æ, –∑–∞ –¥–∞ –º–æ–∂–µ –¥—Ä—É–≥ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –¥–∞:
  //–ø–æ–∫–∞–∑–≤–∞ —Ñ–∏–ª–º–∏,
  //–ø–æ–∫–∞–∑–≤–∞ –≥—Ä–µ—à–∫–∞,
  //–ø–æ–∫–∞–∑–≤–∞ –¥–∞–ª–∏ –∑–∞—Ä–µ–∂–¥–∞,
  //—Ç—ä—Ä—Å–∏ –Ω–æ–≤–∏ —Ñ–∏–ª–º–∏.
};

export default useMovis;
//‚û°Ô∏è –î–∞–≤–∞–º–µ —Ç–∞–∑–∏ –∫—É–∫–∏—á–∫–∞ –Ω–∞ –æ—Å—Ç–∞–Ω–∞–ª–∏—è —Å–≤—è—Ç, –∑–∞ –¥–∞ —Å–µ –∏–∑–ø–æ–ª–∑–≤–∞ –≤ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∏.

//üìö –û–±–æ–±—â–µ–Ω–∏–µ ‚Äì –ø—Ä–µ–¥—Å—Ç–∞–≤–∏ —Å–∏ —Ç–∞–∫–∞:
//–ò–º–∞—à –µ–¥–Ω–æ —á–µ–∫–º–µ–¥–∂–µ (useMovis), –≤ –∫–æ–µ—Ç–æ:
//–í –Ω–∞—á–∞–ª–æ—Ç–æ —Å–µ —Å–ª–∞–≥–∞—Ç –ø–æ–ø—É–ª—è—Ä–Ω–∏ —Ñ–∏–ª–º–∏.
//–ê–∫–æ –Ω—è–∫–æ–π —Ç—ä—Ä—Å–∏ ‚Äì —Ç—ä—Ä—Å–∏—à —Ñ–∏–ª–º–∏ –∏ –≥–∏ —Å–º–µ–Ω—è—à.
//–ê–∫–æ –Ω–µ—â–æ —Å–µ –æ–±—ä—Ä–∫–∞ ‚Äì –∫–∞–∑–≤–∞—à "–û–ø–∞, –≥—Ä–µ—à–∫–∞".
//–ü–æ–∫–∞–∑–≤–∞—à –¥–∞–ª–∏ –∑–∞—Ä–µ–∂–¥–∞—à –≤ –º–æ–º–µ–Ω—Ç–∞.
