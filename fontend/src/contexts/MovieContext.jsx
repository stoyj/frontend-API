/* eslint-disable react-refresh/only-export-components */

//1. –ò–º–ø–æ—Ä—Ç–∏—Ä–∞–º–µ –Ω—É–∂–Ω–∏—Ç–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∏:
import { createContext, useState, useContext, useEffect } from "react";
//1.createContext()	–°—ä–∑–¥–∞–≤–∞ –∫—É—Ç–∏—è —Å –¥–∞–Ω–Ω–∏, –∫–æ—è—Ç–æ –º–æ–∂–µ–º –¥–∞ —Å–ø–æ–¥–µ–ª—è–º–µ –Ω–∞–≤—Å—è–∫—ä–¥–µ
//2.useState()	–°—ä–∑–¥–∞–≤–∞ –ø—Ä–æ–º–µ–Ω–ª–∏–≤–∞ —Å—ä—Å —Å—Ç–æ–π–Ω–æ—Å—Ç, –∫–æ—è—Ç–æ —Å–µ –ø—Ä–æ–º–µ–Ω—è
//3.useContext()	–ü–æ–∑–≤–æ–ª—è–≤–∞ –¥–∞ –¥–æ—Å—Ç—ä–ø–∏–º –∫—É—Ç–∏—è—Ç–∞ –æ—Ç –¥—Ä—É–≥–æ –º—è—Å—Ç–æ
//4.useEffect()	–ò–∑–ø—ä–ª–Ω—è–≤–∞ –Ω–µ—â–æ, –∫–æ–≥–∞—Ç–æ —Å–µ –∑–∞—Ä–µ–¥–∏ –∏–ª–∏ –ø—Ä–æ–º–µ–Ω–∏ –Ω–µ—â–æ

const MovieContext = createContext();
//‚û°Ô∏è –¢–æ–≤–∞ –µ –∫—É—Ç–∏—è—Ç–∞ –∑–∞ –ª—é–±–∏–º–∏—Ç–µ —Ñ–∏–ª–º–∏ üéÅ

export const useMovieContext = () => useContext(MovieContext);
//–°—ä–∑–¥–∞–≤–∞–º–µ –∫—É–∫–∏—á–∫–∞ –∑–∞ –ª–µ—Å–µ–Ω –¥–æ—Å—Ç—ä–ø –¥–æ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞:
//‚û°Ô∏è –¢–æ–≤–∞ –Ω–∏ –ø–æ–º–∞–≥–∞ –ª–µ—Å–Ω–æ –¥–∞ –∏–∑–ø–æ–ª–∑–≤–∞–º–µ –∫—É—Ç–∏—è—Ç–∞ –≤—ä–≤ –≤—Å–µ–∫–∏ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç, –±–µ–∑ –¥–∞ –ø–∏—à–µ–º –º–Ω–æ–≥–æ –∫–æ–¥.

//–°—ä–∑–¥–∞–≤–∞–º–µ –¥–æ—Å—Ç–∞–≤—á–∏–∫–∞ (Provider):
//‚û°Ô∏è –¢–æ–∑–∏ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –æ–±–≤–∏–≤–∞ —Ü—è–ª–æ—Ç–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∏ –¥–∞–≤–∞ –¥–æ—Å—Ç—ä–ø –¥–æ –ª—é–±–∏–º–∏—Ç–µ —Ñ–∏–ª–º–∏.
//–í—Å–∏—á–∫–∏ –¥–µ—Ü–∞ ({children}) –≤—ä—Ç—Ä–µ –≤ –Ω–µ–≥–æ —â–µ –º–æ–≥–∞—Ç –¥–∞ –∏–∑–ø–æ–ª–∑–≤–∞—Ç –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞.
export const MovieProvider = ({ children }) => {
  //–ü—Ä–æ–º–µ–Ω–ª–∏–≤–∞ favorites:
  //‚û°Ô∏è –¢–æ–≤–∞ –µ —Å–ø–∏—Å—ä–∫ —Å –ª—é–±–∏–º–∏—Ç–µ —Ñ–∏–ª–º–∏. –ó–∞–ø–æ—á–≤–∞ –ø—Ä–∞–∑–µ–Ω.
  const [favorites, setFavorites] = useState([]);

  //–ó–∞—Ä–µ–∂–¥–∞–º–µ –æ—Ç localStorage:
  useEffect(() => {
    const storedFavs = localStorage.getItem("favorites");

    if (storedFavs) setFavorites(JSON.parse(storedFavs));
  }, []);
  //‚û°Ô∏è –ö–æ–≥–∞—Ç–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ—Ç–æ —Å–µ —Å—Ç–∞—Ä—Ç–∏—Ä–∞:
  //–í–∑–∏–º–∞–º–µ —Å—Ç–∞—Ä–∏—Ç–µ –ª—é–±–∏–º–∏ –æ—Ç –±—Ä–∞—É–∑—ä—Ä–∞ (–∞–∫–æ –∏–º–∞)
  //–°–ª–∞–≥–∞–º–µ –≥–∏ –≤ favorites

  //–ó–∞–ø–∞–∑–≤–∞–º–µ –≤ localStorage:
  useEffect(() => {
    localStorage.setItem("favorites", JSON.stringify(favorites));
  }, [favorites]);
  //‚û°Ô∏è –í—Å–µ–∫–∏ –ø—ä—Ç, –∫–æ–≥–∞—Ç–æ –ø—Ä–æ–º–µ–Ω–∏–º favorites, –≥–æ –∑–∞–ø–∏—Å–≤–∞–º–µ –≤ –±—Ä–∞—É–∑—ä—Ä–∞, –∑–∞ –¥–∞ –Ω–µ —Å–µ –≥—É–±–∏.

  //–§—É–Ω–∫—Ü–∏–∏ –∑–∞ –ª—é–±–∏–º–∏:
  const addToFavorites = (movie) => {
    setFavorites((prev) => [...prev, movie]);
    //‚û°Ô∏è –î–æ–±–∞–≤—è —Ñ–∏–ª–º –≤ —Å–ø–∏—Å—ä–∫–∞.
  };

  //‚û°Ô∏è –ú–∞—Ö–∞–º–µ —Ñ–∏–ª–º –æ—Ç —Å–ø–∏—Å—ä–∫–∞ –ø–æ ID.
  const removeFromFavorites = (movieId) => {
    setFavorites((prev) => prev.filter((movie) => movie.id !== movieId));
  };

  //‚û°Ô∏è –ê–∫–æ —Ñ–∏–ª–º—ä—Ç –≤–µ—á–µ –µ –≤ –ª—é–±–∏–º–∏ ‚Üí –º–∞—Ö–∞ –≥–æ.
  const toggleFavorites = (movie) => {
    const isAdded = favorites.find((val) => val.id === movie.id);

    if (isAdded) removeFromFavorites(movie.id);
    else addToFavorites(movie);
    //–ê–∫–æ –Ω–µ –µ ‚Üí –¥–æ–±–∞–≤—è –≥–æ.
  };

  const isFavorite = (movieId) => {
    return favorites.some((movie) => movie.id === movieId);
    //‚û°Ô∏è –ü—Ä–æ–≤–µ—Ä—è–≤–∞ –¥–∞–ª–∏ –¥–∞–¥–µ–Ω —Ñ–∏–ª–º –µ –≤ —Å–ø–∏—Å—ä–∫–∞ —Å –ª—é–±–∏–º–∏ (–≤—Ä—ä—â–∞ true –∏–ª–∏ false).
  };

  //–ö–∞–∫–≤–æ —Å–ø–æ–¥–µ–ª—è–º–µ —Å –¥—Ä—É–≥–∏—Ç–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∏:
  const value = {
    favorites,
    addToFavorites,
    removeFromFavorites,
    toggleFavorites,
    isFavorite,
    //‚û°Ô∏è –¢–æ–≤–∞ –µ –≤—Å–∏—á–∫–æ, –∫–æ–µ—Ç–æ –¥—Ä—É–≥–∏—Ç–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∏ –º–æ–≥–∞—Ç –¥–∞ –∏–∑–ø–æ–ª–∑–≤–∞—Ç.
  };

  //–î–∞–≤–∞–º–µ –¥–æ—Å—Ç—ä–ø –¥–æ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞:
  return (
    //‚û°Ô∏è –ö–∞–∑–≤–∞–º–µ: –ï—Ç–æ, —Ç–æ–≤–∞ –µ –Ω–∞—à–∏—è—Ç –∫–æ–Ω—Ç–µ–∫—Å—Ç. –ù–µ–∫–∞ –≤—Å–∏—á–∫–∏ –¥–µ—Ü–∞ (–∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∏) –¥–∞ –≥–æ –ø–æ–ª–∑–≤–∞—Ç
    <MovieContext.Provider value={value}>{children}</MovieContext.Provider>
  );
};
